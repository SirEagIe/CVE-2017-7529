FROM nginx:1.13.1

COPY nginx.conf /etc/nginx/nginx.conf
COPY default.conf /etc/nginx/conf.d/default.conf

RUN echo "deb http://archive.debian.org/debian/ stretch main contrib non-free" > /etc/apt/sources.list
RUN echo "deb http://archive.debian.org/debian/ stretch-proposed-updates main contrib non-free" >> /etc/apt/sources.list
RUN echo "deb http://archive.debian.org/debian-security stretch/updates main contrib non-free" >> /etc/apt/sources.list
RUN apt-get update
RUN apt install -y python3 python3-pip

WORKDIR /app
COPY app.py .
RUN pip3 install flask

COPY entrypoint.sh .
RUN chmod u+x entrypoint.sh

CMD ["./entrypoint.sh"]
